<!-- Wedding Photo Sorter HTML Interface -->
<!-- Save this file as "index.html" in the same directory as the JS file -->

<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Wedding Photo Sorter</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
      margin: 0;
      padding: 0;
      background-color: #f5f5f7;
      display: flex;
      flex-direction: column;
      height: 100vh;
      color: #333;
    }
    
    .header {
      background-color: #fff;
      padding: 15px 20px;
      border-bottom: 1px solid #ddd;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .title {
      font-size: 20px;
      font-weight: 500;
    }
    
    .stats {
      font-size: 14px;
      color: #666;
    }
    
    .setup-container {
      padding: 50px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      flex: 1;
    }
    
    .resume-message {
      background-color: #e8f5e9;
      color: #2e7d32;
      padding: 15px 25px;
      border-radius: 6px;
      margin-bottom: 20px;
      display: none;
    }
    
    .resume-message.visible {
      display: block;
    }
    
    .photo-container {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 20px;
      overflow: hidden;
      position: relative;
    }
    
    .photo-view {
      max-width: 100%;
      max-height: calc(100vh - 180px);
      object-fit: contain;
      border-radius: 4px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }
    
    .controls {
      background-color: #fff;
      padding: 20px;
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 30px;
      border-top: 1px solid #ddd;
    }
    
    .control-group {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .key {
      display: inline-block;
      padding: 8px 12px;
      background-color: #f0f0f0;
      border-radius: 4px;
      font-family: monospace;
      font-weight: bold;
      box-shadow: 0 2px 3px rgba(0, 0, 0, 0.1);
      min-width: 15px;
      text-align: center;
    }
    
    .action {
      font-size: 14px;
    }
    
    button {
      padding: 12px 20px;
      font-size: 16px;
      background-color: #0071e3;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      transition: background-color 0.2s;
    }
    
    button:hover {
      background-color: #0077ed;
    }
    
    button:active {
      background-color: #0062c3;
    }
    
    button + button {
      margin-left: 10px;
    }
    
    .path-display {
      font-size: 13px;
      color: #666;
      margin-top: 8px;
      max-width: 500px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    
    .category-badge {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      padding: 15px 30px;
      font-size: 24px;
      font-weight: bold;
      color: white;
      border-radius: 8px;
      opacity: 0;
      transition: opacity 0.2s;
    }
    
    .yes-badge {
      background-color: rgba(52, 199, 89, 0.9);
    }
    
    .no-badge {
      background-color: rgba(255, 69, 58, 0.9);
    }
    
    .maybe-badge {
      background-color: rgba(255, 159, 10, 0.9);
    }
    
    .fade-in {
      opacity: 1;
    }
    
    .fade-out {
      opacity: 0;
    }
    
    .hidden {
      display: none;
    }
    
    .category-label {
      position: absolute;
      top: 20px;
      right: 20px;
      padding: 8px 16px;
      border-radius: 4px;
      font-weight: bold;
      color: white;
      text-transform: uppercase;
      font-size: 14px;
      opacity: 0;
      transition: opacity 0.3s;
    }
    
    .category-label.visible {
      opacity: 1;
    }
    
    .category-label.yes {
      background-color: rgba(52, 199, 89, 0.9);
    }
    
    .category-label.no {
      background-color: rgba(255, 69, 58, 0.9);
    }
    
    .category-label.maybe {
      background-color: rgba(255, 159, 10, 0.9);
    }
  </style>
</head>
<body>
  <div class="header">
    <div class="title">Wedding Photo Sorter</div>
    <div class="stats" id="stats"></div>
  </div>
  
  <div id="setup-container" class="setup-container">
    <h2>Let's get started sorting your wedding photos!</h2>
    <p>This app will help you quickly sort through your photos using keyboard shortcuts.</p>
    <div id="resume-message" class="resume-message">
      Resuming previous sorting session...
    </div>
    <div style="margin: 30px 0;">
      <button id="select-source">Select Photos Folder</button>
      <div id="source-path" class="path-display"></div>
    </div>
  </div>
  
  <div id="photo-container" class="photo-container hidden">
    <img id="photo-view" class="photo-view" src="" alt="Wedding photo" />
    <div id="category-label" class="category-label"></div>
  </div>
  
  <div id="controls" class="controls hidden">
    <div class="control-group">
      <span class="key">←</span>
      <span class="action">Previous</span>
    </div>
    <div class="control-group">
      <span class="key">→</span>
      <span class="action">Next</span>
    </div>
    <div class="control-group">
      <span class="key">↑</span>
      <span class="action">Yes</span>
    </div>
    <div class="control-group">
      <span class="key">↓</span>
      <span class="action">No</span>
    </div>
    <div class="control-group">
      <span class="key">Space</span>
      <span class="action">Maybe</span>
    </div>
  </div>
  
  <div id="yes-badge" class="category-badge yes-badge">YES</div>
  <div id="no-badge" class="category-badge no-badge">NO</div>
  <div id="maybe-badge" class="category-badge maybe-badge">MAYBE</div>
  
  <script>
    const { ipcRenderer } = require('electron');
    
    // Elements
    const setupContainer = document.getElementById('setup-container');
    const photoContainer = document.getElementById('photo-container');
    const controls = document.getElementById('controls');
    const photoView = document.getElementById('photo-view');
    const stats = document.getElementById('stats');
    const sourcePath = document.getElementById('source-path');
    const selectSourceBtn = document.getElementById('select-source');
    const yesBadge = document.getElementById('yes-badge');
    const noBadge = document.getElementById('no-badge');
    const maybeBadge = document.getElementById('maybe-badge');
    
    // Button event listeners
    selectSourceBtn.addEventListener('click', async () => {
      const result = await ipcRenderer.invoke('select-source-folder');
      if (result) {
        sourcePath.textContent = result.sourceFolder;
        stats.textContent = `Total Photos: ${result.totalPhotos}`;
        
        // Show resume message if there's existing metadata
        const resumeMessage = document.getElementById('resume-message');
        if (result.hasMetadata) {
          resumeMessage.classList.add('visible');
        }
        
        // Switch to photo view mode
        setupContainer.classList.add('hidden');
        photoContainer.classList.remove('hidden');
        controls.classList.remove('hidden');
        
        // Load the first photo
        const photoData = await ipcRenderer.invoke('get-next-photo');
        if (photoData) {
          loadPhoto(photoData);
        }
      }
    });
    
    // Keyboard event listener
    document.addEventListener('keydown', async (event) => {
      // Only process keyboard events if we're in photo viewing mode
      if (photoContainer.classList.contains('hidden')) {
        return;
      }
      
      switch (event.key) {
        case 'ArrowLeft':
          const prevData = await ipcRenderer.invoke('get-prev-photo');
          if (prevData) {
            loadPhoto(prevData);
          }
          break;
          
        case 'ArrowRight':
          const nextData = await ipcRenderer.invoke('get-next-photo');
          if (nextData) {
            loadPhoto(nextData);
          }
          break;
          
        case 'ArrowUp':
          await categorizePhoto('yes');
          break;
          
        case 'ArrowDown':
          await categorizePhoto('no');
          break;
          
        case ' ': // Space key
          await categorizePhoto('maybe');
          break;
      }
    });
    
    // Helper function to load a photo
    function loadPhoto(photoData) {
      photoView.src = `file://${photoData.photo}`;
      stats.textContent = `Photo ${photoData.index + 1} of ${photoData.total}`;
      
      // Update category label
      const categoryLabel = document.getElementById('category-label');
      if (photoData.category) {
        categoryLabel.textContent = photoData.category.toUpperCase();
        categoryLabel.className = `category-label ${photoData.category} visible`;
      } else {
        categoryLabel.className = 'category-label';
      }
    }
    
    // Helper function to categorize a photo
    async function categorizePhoto(category) {
      // Show appropriate badge
      let badge;
      switch (category) {
        case 'yes':
          badge = yesBadge;
          break;
        case 'no':
          badge = noBadge;
          break;
        case 'maybe':
          badge = maybeBadge;
          break;
      }
      
      // Animate badge
      badge.classList.add('fade-in');
      setTimeout(() => {
        badge.classList.remove('fade-in');
        badge.classList.add('fade-out');
        setTimeout(() => {
          badge.classList.remove('fade-out');
        }, 300);
      }, 300);
      
      // Send category to main process
      const result = await ipcRenderer.invoke('categorize-photo', category);
      if (result) {
        loadPhoto(result);
      }
    }
  </script>
</body>
</html>
